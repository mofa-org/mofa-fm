# MoFA FM - AI 脚本创作工作室使用指南

## 功能概述

AI 脚本创作工作室是一个集成了 Kimi AI 和 MiniMax TTS 的播客脚本创作和音频生成工具。

### 核心功能
1. **AI 对话生成脚本** - 与 AI 聊天，轻松创作播客脚本
2. **上传参考文件** - 支持 txt/pdf/md/docx 格式
3. **脚本版本管理** - 自动保存每次修改的版本
4. **一键生成音频** - 直接生成 MP3 播客文件

## 如何访问

### 1. 前提条件
- 已注册并登录 MoFA FM 账号
- 已成为创作者（访问 `/become-creator` 申请）
- 至少创建了一个播客节目

### 2. 访问路径

**方式一：从创作者中心**
1. 登录后访问 `/creator` (创作者中心)
2. 点击顶部的 **"✨ AI 脚本创作工作室"** 按钮

**方式二：直接访问**
- 在浏览器中访问：`http://localhost:5173/creator/ai-studio`

## 使用流程

### 第一步：创建会话

1. 点击 **"新建会话"** 按钮
2. 填写会话标题（例如："第一期 - 人工智能简介"）
3. 可选：关联一个已有的播客节目
4. 点击 **"创建"**

### 第二步：与 AI 对话

在聊天框中输入你的想法，例如：

```
帮我生成一个3分钟的播客脚本，主题是Python编程入门，
要有两个主持人对话，一个叫大牛，一个叫一帆
```

AI 会根据你的需求生成脚本，格式如下：

```markdown
【大牛】大家好！欢迎来到本期节目。

【一帆】今天我们要聊聊 Python 编程。

【大牛】Python 是一门非常适合新手的编程语言...
```

### 第三步：上传参考文件（可选）

1. 点击 **"📎 上传参考文件"** 按钮
2. 选择文件（支持 .txt, .pdf, .md, .docx）
3. 文件内容会自动提取并作为 AI 对话的参考

### 第四步：优化脚本

继续与 AI 对话，优化脚本：

```
可以让对话更幽默一点吗？增加一些编程段子
```

AI 会根据你的反馈修改脚本，所有版本都会自动保存。

### 第五步：生成播客音频

1. 确认脚本无误后，点击右上角的 **"🎙️ 生成播客"** 按钮
2. 输入播客标题
3. 等待生成完成（这是一个异步任务）
4. 生成完成后，可以在节目管理页面查看和发布

## 脚本格式规范

### 角色标记

使用 `【角色名】` 来标记说话人：

```markdown
【大牛】这是大牛说的话。

【一帆】这是一帆说的话。
```

### 支持的角色

**默认角色**：
- `【大牛】` - 男声
- `【一帆】` - 女声

**自定义角色**：
后端管理员可以在 settings.py 中添加更多音色配置

### 脚本结构示例

```markdown
# 第一期：人工智能简介

## 开场

【大牛】大家好！欢迎来到本期节目。我是大牛。

【一帆】我是一帆。今天我们要聊聊人工智能。

## 主题讨论

【大牛】人工智能最近非常火热，你觉得它会改变我们的生活吗？

【一帆】当然！AI 已经在很多领域展现出惊人的能力...

## 结尾

【大牛】好的，今天的节目就到这里。

【一帆】感谢收听，我们下期再见！
```

## 技巧和最佳实践

### 1. 明确你的需求

告诉 AI：
- 播客主题和目标受众
- 预计时长
- 风格和语气（正式/轻松/幽默）
- 主持人角色设定

### 2. 使用参考文件

- 上传相关资料，AI 会基于这些内容生成脚本
- 适合用于：技术文档、新闻稿、研究报告等

### 3. 迭代优化

- 不要期望一次生成完美的脚本
- 通过多轮对话逐步优化
- 可以要求 AI 调整某一段落

### 4. 查看历史版本

- 右侧脚本区域会显示所有历史版本
- 点击版本可以查看之前的内容
- 如果改坏了可以参考旧版本

### 5. 控制脚本长度

建议：
- 3 分钟播客：约 500-800 字
- 5 分钟播客：约 800-1200 字
- 10 分钟播客：约 1500-2000 字

## 快捷键

- `Ctrl + Enter` - 发送消息
- `Ctrl + C` - 复制脚本（在脚本预览区）

## 常见问题

### Q: AI 生成的脚本可以编辑吗？

A: 当前版本只能通过对话让 AI 修改。你可以说："把第一段改成..."

### Q: 生成音频需要多久？

A: 取决于脚本长度，通常 3-5 分钟。生成是异步的，可以在节目管理页面查看进度。

### Q: 可以使用自己的音色吗？

A: 需要后端管理员在配置中添加 MiniMax 音色 ID。联系管理员配置。

### Q: 上传的文件会被保存吗？

A: 是的，文件会保存在服务器上，并自动提取文本供 AI 参考。

### Q: 如何删除会话？

A: 当前版本暂不支持删除，未来版本会添加此功能。

### Q: AI 不理解我的需求怎么办？

A: 尝试更具体的描述，或者分步骤引导 AI。例如：
```
第一步：先帮我写开场白
第二步：现在写主题讨论部分
```

## 开发和调试

### 本地开发

```bash
# 启动后端
cd backend
python manage.py runserver

# 启动 Celery
celery -A config worker -l info

# 启动 Redis
redis-server

# 启动前端
cd frontend
npm run dev
```

### API 测试

使用浏览器开发者工具查看网络请求：

**创建会话**：
```
POST /api/v1/podcasts/script-sessions/
```

**发送消息**：
```
POST /api/v1/podcasts/script-sessions/{id}/chat/
```

**上传文件**：
```
POST /api/v1/podcasts/script-sessions/{id}/upload_file/
```

**生成播客**：
```
POST /api/v1/podcasts/episodes/generate/
```

## 技术架构

### 前端
- **框架**: Vue 3 + Composition API
- **路由**: `/creator/ai-studio`
- **组件**: `AIScriptStudio.vue`
- **API 客户端**: `src/api/podcasts.js`

### 后端
- **视图**: `ScriptSessionViewSet`
- **AI 服务**: `script_ai.py` (Kimi API)
- **TTS 客户端**: `minimax_client.py`
- **音频生成**: `generator.py`
- **异步任务**: `generate_podcast_task` (Celery)

### 数据流

```
用户输入 → 前端 → API → Kimi AI → 生成脚本 → 保存到数据库
                                              ↓
                                         用户点击生成
                                              ↓
                                        Celery 异步任务
                                              ↓
                                     MiniMax TTS (WebSocket)
                                              ↓
                                     音频拼接 + 静音插入
                                              ↓
                                        导出 MP3 文件
```

## 下一步改进

- [ ] 支持实时预览 TTS 效果
- [ ] 添加脚本模板库
- [ ] 支持批量生成多集
- [ ] 添加背景音乐和音效
- [ ] 支持导出脚本为 Word/PDF
- [ ] 添加协作功能（多人编辑）

## 反馈和支持

如有问题或建议，请联系开发团队或在 GitHub 提 Issue。
